<div class="imgbackground">
</div>
<div class="register-form">
  <div>
    <h4 class="text-center">Rejestracja</h4>
  </div>
  @if (error$ | async) {
    <div class="mt-2 mb-2">
      <div class="alert alert-danger">
        {{ error$ | async }}
      </div>
    </div>
  }
  <form [formGroup]="registerForm">
    <div class="form-group mt-2 mb-2">
      <label for="email-input" class="text-white bg-dark label-register-form">Email</label>
      <input id="email-input" type="email" class="form-control" formControlName="emailAddress" placeholder="Wpisz adres email" />
      @if (registerForm.dirty) {
        @for (error of registerForm.get('emailAddress')?.errors | keyvalue; track error) {
          @if (error.value && this.registerForm.get('emailAddress')?.dirty) {
            <div class="invalid-feedback d-block bg-dark label-register-form text-break">
              {{ getErrorMessage(error) }}
            </div>
          }
        }
      }
    </div>
    <div class="form-group mt-2 mb-2">
      <label for="password-input" class="text-white bg-dark label-register-form">Hasło</label>
      <input id="password-input" type="password" class="form-control" formControlName="password" placeholder="Wpisz hasło" />
      @if (registerForm.dirty) {
        @for (error of registerForm.get('password')?.errors | keyvalue; track error) {
          @if (error.value && this.registerForm.get('password')?.dirty) {
            <div class="invalid-feedback d-block bg-dark label-register-form text-break">
              {{ getErrorMessage(error) }}
            </div>
          }
        }
      }
      @if (registerForm.errors) {
        @for (error of registerForm.errors | keyvalue; track error) {
          @if (error.value && this.registerForm.get('confirmPassword')?.dirty) {
            <div class="invalid-feedback d-block bg-dark label-register-form text-break">
              {{ error.value }}
            </div>
          }
        }
      }
    </div>
    <div class="form-group mt-2 mb-2">
      <label for="confirm-password-input" class="text-white bg-dark label-register-form">Powtórz hasło</label>
      <input id="confirm-password-input" type="password" class="form-control" formControlName="confirmPassword" placeholder="Wpisz hasło" />
      @if (registerForm.dirty) {
        @for (error of registerForm.get('confirmPassword')?.errors | keyvalue; track error) {
          @if (error.value && this.registerForm.get('confirmPassword')?.dirty) {
            <div class="invalid-feedback d-block bg-dark label-register-form text-break">
              {{ getErrorMessage(error) }}
            </div>
          }
        }
      }
      @if (registerForm.errors) {
        @for (error of registerForm.errors | keyvalue; track error) {
          @if (error.value && this.registerForm.get('confirmPassword')?.dirty) {
            <div class="invalid-feedback d-block bg-dark label-register-form text-break">
              {{ error.value }}
            </div>
          }
        }
      }
    </div>
    <div class="mb-2">
      <a [routerLink]="['/login']">Wróc do logowania</a>
    </div>
    <div>
      <app-spinner-button
        [className]="'btn btn-primary me-2'"
        [buttonText]="'Zarejestruj'"
        [version]="spinnerVersion"
        [disabled]="(loginRequestState$ | async) === 'loading'"
        (buttonClick)="onSubmit(); $event.preventDefault()">
      </app-spinner-button>
    </div>
  </form>
</div>
